{% extends 'base.html.twig' %}

{% block body %}
<div class="content">
    <div class="middle-content">
        {% if app.session.flashBag.has('info') %}
            <div class="alert_success">
                {{ app.session.flashBag.get('info')|first }}
            </div>
        {% endif %}

        <h2 class="content-head is-center">Your latest releases</h2>

        {% if repos is empty %}
            <p><i>Here are some sample display.</i></p>
        {% endif %}

        <input type="checkbox" class="read-more-state" id="read-more" />

        <table class="pure-table">
            <thead>
                <tr>
                    <th>Repository</th>
                    <th>Last&nbsp;version</th>
                    <th>Published&nbsp;at</th>
                </tr>
            </thead>

            <tbody class="read-more-wrap">
                {% for repo in repos -%}
                    <tr class="{% if loop.index is odd %}pure-table-odd{% endif %} {% if loop.index > 10 %}read-more-target{% endif %}">
                        <td data-th="Repo">
                            <img class="repo-avatar" src="{{ repo.ownerAvatar }}&amp;s=25"/>
                            <a href="https://github.com/{{ repo.fullName }}" title="{{ repo.description }}">{{ repo.fullName }}</a>
                        </td>
                        <td data-th="Last">
                            {% if repo.name and repo.name != repo.tagName -%}
                                {{ repo.name }} (<a href="{{ repo|link_to_version }}">{{ repo.tagName }}</a>)
                            {%- else -%}
                                <a href="{{ repo|link_to_version }}">{{ repo.tagName }}</a>
                            {%- endif %}

                            {% if repo.prerelease -%}
                                <span class="label_prerelease">pre-release</span>
                            {% endif -%}
                        </td>
                        <td data-th="Date">
                            <time datetime="{{ repo.createdAt|date("c") }}" title="{{ repo.createdAt|date("c") }}">{{ repo.createdAt|time_diff }}</time>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td data-th="Repo">
                            <img class="repo-avatar" src="https://avatars2.githubusercontent.com/u/5909549?v=3&amp;s=25"/>
                            <a href="#">sample/sample</a>
                        </td>
                        <td data-th="Last">First release (<a href="#">v1.0.0</a>)</td>
                        <td data-th="Date"><time datetime="{{ app.user.createdAt|date("c") }}" title="{{ app.user.createdAt|date("c") }}">{{ app.user.createdAt|time_diff }}</time></td>
                    </tr>
                    <tr class="pure-table-odd">
                        <td data-th="Repo">
                            <img class="repo-avatar" src="https://avatars2.githubusercontent.com/u/5909549?v=3&amp;s=25"/>
                            <a href="#">sample/sample</a>
                        </td>
                        <td data-th="Last">
                            Prepare first release (<a href="#">v1.0.0-alpha.1</a>)
                            <span class="label_prerelease">pre-release</span>
                        </td>
                        <td data-th="Date"><time datetime="{{ date("-2days")|date("c") }}" title="{{ date("-2days")|date("c") }}">{{ date("-2days")|time_diff }}</time></td>
                    </tr>
                {% endfor -%}
            </tbody>
        </table>

        {% if repos|length > 10 %}
            <p class="is-center">
                <label for="read-more" class="read-more-trigger pure-button" data-more-items="{{ repos|length-10 }}"></label>
            </p>
        {% endif %}
    </div>
</div>
{% endblock %}
